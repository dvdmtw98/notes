---
title: Malware Static Analysis
tags:
  - security
  - malware
  - defense
date: 2026-01-25 19:45:34 +0530
updated: 2026-01-27 22:04:15 +0530
---

It is a good idea to begin static analysis by using a service like VirusTotal to find out if the program is known to be malicious.  

### Finding Strings
Legitimate binaries almost **always** contain many **strings**.  
The end of a string is denoted using the NULL terminator (`x00`).

On Windows strings can be in ASCII or Unicode format.  
Windows APIs normally use wide string (2 bytes) to represent characters.  

> [!IMPORTANT] Windows APIs use of UTF-16
> - When the Windows NT kernel was being developed UTF-8 did not exist.  
> - UCS-2 was the standard back then which Microsoft adopted.  
> - UCS-2 later evolved into the modern present UTF-16.  

Utilities like `strings` will also return words that are not real strings.  
This happens cause memory addresses, CPU instruction, or data could sometimes resemble printable characters.    

### Packed and Obfuscated Programs
**Obfuscated** programs are ones who execution the author is trying to hide.  
**Packed** programs are a subset of obfuscated programs where the program is compressed and cannot be analyzed.  

These program often include the functions `LoadLibrary` and `GetProcAddress` which are used to gain access to additional functionality.  

When a packed program is run a small wrapper program is run that decompresses the packed file and then runs the unpacked file.  
When a packed program is analyzed only the wrapper can be dissected.  
The wrapper is also called stub and loader.  

##### Detecting Packers
PEiD can be used to identify the packer and compiler that was used.  
Programs packed using UPX can be unpacked using the following command:

```cmd
upx -d PackedProgram.exe
```

Some of the plugins in PEiD will automatically execute the program (be careful).
